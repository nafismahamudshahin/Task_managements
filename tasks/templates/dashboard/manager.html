{% extends "dashboard/dashboard.html" %}
{% block sub_title %}Manager{% endblock sub_title %}
{% block tasks %}
    <section class="container mx-6">
        {% if messages %}
            {% for message in messages %}
                <h3>{{message}}</h3>
            {% endfor %}
        {% endif %}
        <div class="shadow-sm p-4">
            {% comment %} header {% endcomment %}
            <div class="grid grid-cols-4 text-gray-600 text-lg border-b border-gray-100 pb-3">
                <h3>TASK TITLE</h3>
                <h3>PRIORITY</h3>
                <h3>TEAM</h3>
                <h3>CREATED AT</h3>
            </div>
            {% comment %} table body {% endcomment %}
                <div class="table_body">
              {% comment %} task 1 {% endcomment %}
                {% comment %} database tasks {% endcomment %}
                {% for task in tasks %}
                    <div class="grid grid-cols-4 text-gray-600 text-lg border-b border-gray-100 py-2">
                        <div class="flex justify-between gap-2">
                            <div class="h-2 w-2 bg-red-500 rounded-full"></div>
                            <a href="{% url 'task' task.id %}">
                                <h3>{{task.task_name}}</h3>
                            </a>
                            <div class="flex gap-2">
                                <form action="{% url 'update-task' task.id %}">
                                    {% csrf_token %}
                                    <button class="bg-green-500 px-3">Edit</button>
                                </form>
                                {% comment %} <a class="bg-green-500 px-3" href="{% url 'update-task' task.id %}">Edit</a> {% endcomment %}
                                {% comment %} delete button {% endcomment %}
                                <form  action="{% url 'delete_task_item' task.id %}" method = "POST">
                                    {% csrf_token %}
                                    <button class="bg-red-500 text-white px-3" type=submit >Delete</button>
                                </form>
                            </div>
                        </div>
                        <div>
                            <span class="bg-gray-100 py-1 px-3 text-red-400 font-semibold rounded">
                                {% if task.details.priority %}
                                    {{task.details.get_priority_display}}
                                {% endif %}
                            </span>
                        </div>
                        <div>
                            <div class="flex -space-x-2">
                                {% for user in task.assigne_to.all %}
                                    <div class="bg-rose-500 w-7 h-7 flex items-center justify-center text-white rounded-full text-sm">
                                        {{user.first_name|slice:":2"}}
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div>
                            <span class="text-gray-500">
                                {{task.created_at | timesince}}
                            </span>
                        </div>
                    </div>
                {% endfor %}
                </div>
        </div>
    </section>
{% endblock tasks %}